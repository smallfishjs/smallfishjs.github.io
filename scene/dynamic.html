<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Creating a dynamically configurable page | smallfish</title>
    <meta name="description" content="An React solution for back-office system.">
    
    
    <link rel="preload" href="/assets/css/0.styles.02904f7e.css" as="style"><link rel="preload" href="/assets/js/app.dbb79151.js" as="script"><link rel="preload" href="/assets/js/3.e17a9923.js" as="script"><link rel="preload" href="/assets/js/9.b715be2f.js" as="script"><link rel="prefetch" href="/assets/js/10.a1a462b2.js"><link rel="prefetch" href="/assets/js/11.f5e6ab30.js"><link rel="prefetch" href="/assets/js/12.d6d495ff.js"><link rel="prefetch" href="/assets/js/13.a09db50a.js"><link rel="prefetch" href="/assets/js/14.4a6c6c1d.js"><link rel="prefetch" href="/assets/js/15.3ee11541.js"><link rel="prefetch" href="/assets/js/16.377e61b3.js"><link rel="prefetch" href="/assets/js/17.ad13e981.js"><link rel="prefetch" href="/assets/js/18.ca5fadbe.js"><link rel="prefetch" href="/assets/js/19.74f9ca92.js"><link rel="prefetch" href="/assets/js/20.0c726915.js"><link rel="prefetch" href="/assets/js/21.cec7863f.js"><link rel="prefetch" href="/assets/js/22.d9156cd0.js"><link rel="prefetch" href="/assets/js/23.8d650c59.js"><link rel="prefetch" href="/assets/js/24.b2be5d6e.js"><link rel="prefetch" href="/assets/js/25.c3cdd6c0.js"><link rel="prefetch" href="/assets/js/26.6adb1560.js"><link rel="prefetch" href="/assets/js/27.36c24168.js"><link rel="prefetch" href="/assets/js/28.49a8889e.js"><link rel="prefetch" href="/assets/js/29.e0abad37.js"><link rel="prefetch" href="/assets/js/30.c515804e.js"><link rel="prefetch" href="/assets/js/31.4e003572.js"><link rel="prefetch" href="/assets/js/32.4b2257b9.js"><link rel="prefetch" href="/assets/js/33.abfb0c5e.js"><link rel="prefetch" href="/assets/js/34.aa5152c7.js"><link rel="prefetch" href="/assets/js/35.52bead75.js"><link rel="prefetch" href="/assets/js/36.57b418df.js"><link rel="prefetch" href="/assets/js/37.c170a2db.js"><link rel="prefetch" href="/assets/js/38.5721ac38.js"><link rel="prefetch" href="/assets/js/39.5acf6df4.js"><link rel="prefetch" href="/assets/js/4.f206c44b.js"><link rel="prefetch" href="/assets/js/40.0b5708b1.js"><link rel="prefetch" href="/assets/js/41.0430bb26.js"><link rel="prefetch" href="/assets/js/42.7a6b1c0a.js"><link rel="prefetch" href="/assets/js/5.cbb16fe7.js"><link rel="prefetch" href="/assets/js/6.19619c44.js"><link rel="prefetch" href="/assets/js/7.8f31b0d3.js"><link rel="prefetch" href="/assets/js/8.44f732a4.js"><link rel="prefetch" href="/assets/js/vendors~docsearch.219b40d1.js">
    <link rel="stylesheet" href="/assets/css/0.styles.02904f7e.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">smallfish</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/start/" class="nav-link">Using smallfish</a></div><div class="nav-item"><a href="/scene/" class="nav-link router-link-active">Scene</a></div><div class="nav-item"><a href="/tool/" class="nav-link">Tool</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">Languages</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/scene/dynamic.html" class="nav-link router-link-exact-active router-link-active">English</a></li><li class="dropdown-item"><!----> <a href="/zh/scene/dynamic.html" class="nav-link">简体中文</a></li></ul></div></div> <a href="https://github.com/smallfishjs/smallfish" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/start/" class="nav-link">Using smallfish</a></div><div class="nav-item"><a href="/scene/" class="nav-link router-link-active">Scene</a></div><div class="nav-item"><a href="/tool/" class="nav-link">Tool</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">Languages</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/scene/dynamic.html" class="nav-link router-link-exact-active router-link-active">English</a></li><li class="dropdown-item"><!----> <a href="/zh/scene/dynamic.html" class="nav-link">简体中文</a></li></ul></div></div> <a href="https://github.com/smallfishjs/smallfish" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>Scene Solution</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/scene/" class="sidebar-link">What is a scene solution</a></li><li><a href="/scene/mf.html" class="sidebar-link">Micro Front-end</a></li><li><a href="/scene/antd-form.html" class="sidebar-link">Stardard antd search form</a></li><li><a href="/scene/form-modal.html" class="sidebar-link">Override the value in antd Form Modal</a></li><li><a href="/scene/proxy.html" class="sidebar-link">Debug online</a></li><li><a href="/scene/request.html" class="sidebar-link">Handling web request</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="creating-a-dynamically-configurable-page"><a href="#creating-a-dynamically-configurable-page" aria-hidden="true" class="header-anchor">#</a> Creating a dynamically configurable page</h1> <p>In smallfish you can dynamically configure component libraries using <code>smallfish/dcc</code> by turning on the <code>dcc</code> (Dynamic Configuration Component) configuration.</p> <h2 id="what-is-the-dynamic-configuration-component"><a href="#what-is-the-dynamic-configuration-component" aria-hidden="true" class="header-anchor">#</a> What is the dynamic configuration component?</h2> <p><code>dcc</code> is a development mode that describes the local page structure through Schema, provides a matching component data association library, and implements a scene that can dynamically configure the page.</p> <p>A Schema is like this:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> schema <span class="token operator">=</span> <span class="token punctuation">{</span>
  api<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    getList<span class="token punctuation">:</span> <span class="token string">'/api/list'</span><span class="token punctuation">,</span>
    getUser<span class="token punctuation">:</span> <span class="token string">'/api/user'</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  root<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    id<span class="token punctuation">:</span> <span class="token string">'antd-pro-layout'</span><span class="token punctuation">,</span>
    componentName<span class="token punctuation">:</span> <span class="token string">'AntdProLayout'</span><span class="token punctuation">,</span>
    props<span class="token punctuation">:</span> <span class="token punctuation">{</span>
      id<span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    children<span class="token punctuation">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">{</span>
        id<span class="token punctuation">:</span> <span class="token string">'basic-table'</span><span class="token punctuation">,</span>
        componentName<span class="token punctuation">:</span> <span class="token string">'BasicTable'</span><span class="token punctuation">,</span>
        props<span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><p>In fact, it follows:</p> <div class="language-jsx extra-class"><pre class="language-jsx"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">AntdProLayout</span></span> <span class="token attr-name">id</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>id<span class="token punctuation">}</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
  </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">BasicTable</span></span> <span class="token punctuation">/&gt;</span></span><span class="token plain-text">
</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token class-name">AntdProLayout</span></span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>It's the same, but because abstraction becomes a Schema, it can match the data dynamics, which means that the length of the page can be determined by the data of the server.</p> <h2 id="dynamic-configuration-component"><a href="#dynamic-configuration-component" aria-hidden="true" class="header-anchor">#</a> Dynamic configuration component</h2> <p>In a page configurable scenario, component associations and data mappings are often difficult to handle when building rich interactive applications.</p> <p>Generally speaking, similar configurable forms in the industry are generally SchemaBuilder -&gt; Schema -&gt; SchemaRender, in which the information about the relationship between components and data flow is usually described by Schema.</p> <p>However, this way makes Schema difficult to maintain and complicated to configure. This is because the previous ideas are component partitioning according to the dimensions of the UI component split, but in <code>smallfish/dcc</code>, we divide it by business module.</p> <p>That is to say, we are separated from the dimension of the UI, from the perspective of product business (data perspective) to divide the components, and separate the business components (Business Components).</p> <p>But a business module will form a business process with multiple business modules, and this business process is a closed loop. In <code>smallfish/dcc</code> we represent the concept of <code>DataContainer</code>.</p> <p>Usually a system contains multiple business processes, each of which is independent of each other, but may collect system information uniformly. The outermost layer in <code>smallfish/dcc</code> is <code>GlobalContainer</code>, which is called <code>RenderComponent</code>. Rendering Schema is automatically added and does not require manual processing by the user.</p> <h3 id="smallfish-dcc-solved-problems"><a href="#smallfish-dcc-solved-problems" aria-hidden="true" class="header-anchor">#</a> smallfish/dcc solved problems</h3> <p>In summary, <code>smallfish/dcc</code> provides a set of development methods to implement the <code>dcc</code> development model, in which the proposed three-tier component structure can solve the problem of the relationship between management components in dynamic configuration.</p> <ul><li>GlobalContainer: represents a business system that provides globalData at the data level</li> <li>DataContainer: represents a business process, providing storeData at the data level</li> <li>BusinessComponent: Represents a business module that manages itself at the data level.</li></ul> <p>The underlying relationship is from the bottom of the Schema to the various business components.</p> <h2 id="using-smallfish-dcc"><a href="#using-smallfish-dcc" aria-hidden="true" class="header-anchor">#</a> Using smallfish/dcc</h2> <h3 id="rendering-by-schema"><a href="#rendering-by-schema" aria-hidden="true" class="header-anchor">#</a> Rendering by Schema</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// enabled in the config/config.js configuration item</span>
<span class="token punctuation">{</span>
  dcc<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</code></pre></div><p>and import <code>smallfish/dcc</code>:</p> <div class="language-jsx extra-class"><pre class="language-jsx"><code><span class="token keyword">import</span> React <span class="token keyword">from</span> <span class="token string">'smallfish/react'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> DataContainer<span class="token punctuation">,</span> RenderComponent <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'smallfish/dcc'</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> schema <span class="token operator">=</span> <span class="token punctuation">{</span>
  ppi<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    getWife<span class="token punctuation">:</span> <span class="token string">''</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  root<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    id<span class="token punctuation">:</span> <span class="token string">'parent'</span><span class="token punctuation">,</span>
    componentName<span class="token punctuation">:</span> <span class="token string">'Parent'</span><span class="token punctuation">,</span>
    props<span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    children<span class="token punctuation">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">{</span>
        id<span class="token punctuation">:</span> <span class="token string">'sun'</span><span class="token punctuation">,</span>
        componentName<span class="token punctuation">:</span> <span class="token string">'Sun'</span><span class="token punctuation">,</span>
        props<span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span>
        id<span class="token punctuation">:</span> <span class="token string">'daughter'</span><span class="token punctuation">,</span>
        componentName<span class="token punctuation">:</span> <span class="token string">'Daughter'</span><span class="token punctuation">,</span>
        props<span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> Parent <span class="token operator">=</span> <span class="token function">DataContainer</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> children <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">Parent </span><span class="token punctuation">{</span>children<span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
  Car<span class="token punctuation">:</span> <span class="token string">'GTR'</span><span class="token punctuation">,</span>
  House<span class="token punctuation">:</span> <span class="token string">'Chengdu'</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
Parent<span class="token punctuation">.</span>displayName <span class="token operator">=</span> <span class="token string">'Parent'</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token function-variable function">Sun</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> storeData <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">sun has </span><span class="token punctuation">{</span>storeData<span class="token punctuation">.</span>car<span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">;</span>
Sun<span class="token punctuation">.</span>displayName <span class="token operator">=</span> <span class="token string">'Sun'</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token function-variable function">Cat</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> name <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">cat's master firstname is </span><span class="token punctuation">{</span>name<span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">;</span>
Cat<span class="token punctuation">.</span>displayName <span class="token operator">=</span> <span class="token string">'Cat'</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token function-variable function">Daughter</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> storeData<span class="token punctuation">,</span> GlobalConsumer <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
    Daughter has </span><span class="token punctuation">{</span>storeData<span class="token punctuation">.</span>house<span class="token punctuation">}</span><span class="token plain-text">
    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">GlobalConsumer</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
      </span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> globalData <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Cat</span></span> <span class="token attr-name">name</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>globalData<span class="token punctuation">.</span>firstname<span class="token punctuation">}</span></span> <span class="token punctuation">/&gt;</span></span><span class="token punctuation">}</span><span class="token plain-text">
    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token class-name">GlobalConsumer</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
  </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
Daughter<span class="token punctuation">.</span>displayName <span class="token operator">=</span> <span class="token string">'Daughter'</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">RenderComponent</span></span>
    <span class="token attr-name">schema</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>schema<span class="token punctuation">}</span></span>
    <span class="token attr-name">components</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">[</span>Parent<span class="token punctuation">,</span> Sun<span class="token punctuation">,</span> Daughter<span class="token punctuation">]</span><span class="token punctuation">}</span></span>
    <span class="token attr-name">globalData</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span>
      firstname<span class="token punctuation">:</span> <span class="token string">'jack'</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">}</span></span>
  <span class="token punctuation">/&gt;</span></span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="associating-components-with-setstoredata-and-storedata"><a href="#associating-components-with-setstoredata-and-storedata" aria-hidden="true" class="header-anchor">#</a> Associating components with setStoreData and storeData</h3> <p>When a component is wrapped by <code>DataContainer</code>, it represents a business process with the ability to pass data down. Its subcomponents can access business process data via <code>props.storeData</code> and set up business processes via <code>props.setStoreData</code>.</p> <div class="language-jsx extra-class"><pre class="language-jsx"><code><span class="token keyword">const</span> Parent <span class="token operator">=</span> <span class="token function">DataContainer</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> children <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">Parent </span><span class="token punctuation">{</span>children<span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
  car<span class="token punctuation">:</span> <span class="token string">'GTR'</span><span class="token punctuation">,</span> <span class="token comment">// initialized store: { car: 'GTR' }</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
Parent<span class="token punctuation">.</span>displayName <span class="token operator">=</span> <span class="token string">'Parent'</span><span class="token punctuation">;</span>

<span class="token comment">// subcomponents can get { car: 'GTR' } via storeData</span>
<span class="token keyword">const</span> <span class="token function-variable function">Sun</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> storeData <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">sun has </span><span class="token punctuation">{</span>storeData<span class="token punctuation">.</span>car<span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">;</span>
Sun<span class="token punctuation">.</span>displayName <span class="token operator">=</span> <span class="token string">'Sun'</span><span class="token punctuation">;</span>

<span class="token comment">// subcomponents can also set data via setStoreData</span>
<span class="token keyword">const</span> <span class="token function-variable function">Sun</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> storeData<span class="token punctuation">,</span> setStoreData <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// Update car to BMW, then the car read by the parent and child components will change</span>
  <span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token function">setStoreData</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      car<span class="token punctuation">:</span> <span class="token string">'BMW'</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">return</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">sun has </span><span class="token punctuation">{</span>storeData<span class="token punctuation">.</span>car<span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
Sun<span class="token punctuation">.</span>displayName <span class="token operator">=</span> <span class="token string">'Sun'</span><span class="token punctuation">;</span>
</code></pre></div><p>And all of these relationships are decentralized to the component layer, there is no performance in the Schema, this is the core idea of ​​<code>smallfish/dcc</code>: let the business components handle the context of the relationship, but to remain independent to <code>storeData</code> As an input and output interface.</p> <h3 id="processing-global-data-with-globaldata-and-setglobaldata"><a href="#processing-global-data-with-globaldata-and-setglobaldata" aria-hidden="true" class="header-anchor">#</a> Processing global data with globalData and setGlobalData</h3> <p>A business system may have multiple business processes, each of which is a business component of a <code>DataContainer</code> package, and <code>globalData</code> is a solution to the problem of manipulating data across multiple business process components.</p> <div class="language-jsx extra-class"><pre class="language-jsx"><code><span class="token keyword">const</span> Parent <span class="token operator">=</span> <span class="token function">DataContainer</span><span class="token punctuation">(</span>
  <span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> children<span class="token punctuation">,</span> GlobalConsumer <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">GlobalConsumer</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
            
      </span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> globalData<span class="token punctuation">,</span> setGlobalData <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
          Parent name: </span><span class="token punctuation">{</span>globalData<span class="token punctuation">.</span>firstname<span class="token punctuation">}</span><span class="token plain-text"> has: </span><span class="token punctuation">{</span>children<span class="token punctuation">}</span><span class="token plain-text">
        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span></span><span class="token punctuation">&gt;</span></span>
      <span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token plain-text">
          
    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token class-name">GlobalConsumer</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span>
    car<span class="token punctuation">:</span> <span class="token string">'GTR'</span><span class="token punctuation">,</span> <span class="token comment">// initialized globalData: { car: 'GTR' }</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
Parent<span class="token punctuation">.</span>displayName <span class="token operator">=</span> <span class="token string">'Parent'</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">RenderComponent</span></span>
    <span class="token attr-name">schema</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>schema<span class="token punctuation">}</span></span>
    <span class="token attr-name">components</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">[</span>Parent<span class="token punctuation">,</span> Sun<span class="token punctuation">,</span> Daughter<span class="token punctuation">]</span><span class="token punctuation">}</span></span>
    <span class="token attr-name">globalData</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span>
      <span class="token comment">// global data</span>
      Firstname<span class="token punctuation">:</span> <span class="token string">'jack'</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">}</span></span>
  <span class="token punctuation">/&gt;</span></span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="setting-global-configuration-via-globalconfig"><a href="#setting-global-configuration-via-globalconfig" aria-hidden="true" class="header-anchor">#</a> Setting global configuration via globalConfig</h3> <p>Because RenderComponent is rendered to a separate dom element according to Schema, it is localized. To match the global page flow, you need to pass in some common configuration, such as: api, global unified processing request method.</p> <p>These can all be achieved with the <code>globalConfig</code> property:</p> <div class="language-jsx extra-class"><pre class="language-jsx"><code><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
        
    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">RenderComponent</span></span>
      <span class="token attr-name">Schema</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>schema<span class="token punctuation">}</span></span>
      <span class="token attr-name">Components</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">[</span>Parent<span class="token punctuation">,</span> Sun<span class="token punctuation">,</span> Daughter<span class="token punctuation">]</span><span class="token punctuation">}</span></span>
      <span class="token attr-name">globalData</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span>
        <span class="token comment">// global data</span>
        firstname<span class="token punctuation">:</span> <span class="token string">'jack'</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">}</span></span>
      <span class="token attr-name">globalConfig</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span>
        api<span class="token punctuation">:</span> shema<span class="token punctuation">.</span>api<span class="token punctuation">,</span>
        ajax<span class="token punctuation">,</span>
        rootPath<span class="token punctuation">:</span> <span class="token string">'/test'</span><span class="token punctuation">,</span>
        router<span class="token punctuation">,</span> <span class="token comment">// Since RenderComponent is a separate piece, the route needs to be passed globally.</span>
      <span class="token punctuation">}</span><span class="token punctuation">}</span></span>
    <span class="token punctuation">/&gt;</span></span><span class="token plain-text">
      
  </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/smallfishjs/smallfish/edit/master/docs/scene/dynamic.md" target="_blank" rel="noopener noreferrer">Edit this page on GitHub</a> <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></div> <div class="last-updated"><span class="prefix">Last Updated: </span> <span class="time">6/11/2019, 3:30:14 PM</span></div></footer> <!----> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.dbb79151.js" defer></script><script src="/assets/js/3.e17a9923.js" defer></script><script src="/assets/js/9.b715be2f.js" defer></script>
  </body>
</html>
